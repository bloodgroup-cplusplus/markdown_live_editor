
    <html>
      <head><meta charset="UTF-8"><title>Markdown Preview</title></head>
      <body><h1><strong>API Versioning: Planning for Change</strong></h1>
<p>Let’s see why versioning matters.</p>
<h3><strong>The Breaking Change Disaster</strong></h3>
<p>Imagine you built a successful API. You have 1000 mobile apps using it. Your API returns user data like this:</p>
<p>Old API:</p>
<pre><code class="language-bash"> GET /user/123
</code></pre>
<pre><code class="language-json"> {  &quot;name&quot;: &quot;John Doe&quot;,  &quot;email&quot;: &quot;john@example.com&quot;}
</code></pre>
<p>One day, you realize &quot;Wait! We need separate first and last names!&quot; So you change it to:</p>
<p>New API:</p>
<pre><code class="language-bash"> GET /user/123
</code></pre>
<pre><code class="language-json"> {  &quot;first_name&quot;: &quot;John&quot;,  &quot;last_name&quot;: &quot;Doe&quot;,  &quot;email&quot;: &quot;john@example.com&quot;}
</code></pre>
<p><strong>What happens?</strong></p>
<p>All 1000 apps crash instantly! They're expecting <code>name</code>, but now there's <code>first_name</code> and <code>last_name</code>. Their code breaks:</p>
<p>// Old app code</p>
<pre><code class="language-javascript">
console.log(user.name)  // undefined\! The field doesn't exist anymore\!
</code></pre>
<p>This is called a <strong>breaking change</strong>, and it's a disaster!</p>
<h3><strong>The Solution: API Versioning</strong></h3>
<p>Versioning is like saying &quot;Hey, I'm making changes, but I'll keep the old version running for those who need it.&quot;</p>
<p>Let’s see  the right way:</p>
<p>Version 1 (Old apps use this):</p>
<pre><code class="language-bash"> GET /v1/user/123
</code></pre>
<pre><code class="language-json">
{  &quot;name&quot;: &quot;John Doe&quot;,  &quot;email&quot;: &quot;john@example.com&quot;}
</code></pre>
<p>Version 2 (New apps use this):</p>
<pre><code class="language-bash">
GET /v2/user/123
</code></pre>
<pre><code class="language-json">
{  &quot;first_name&quot;: &quot;John&quot;,  &quot;last_name&quot;: &quot;Doe&quot;,  &quot;email&quot;: &quot;john@example.com&quot;}

</code></pre>
<p>Now:</p>
<ul>
<li>
<p>Old apps keep working (using v1)</p>
</li>
<li>
<p>New apps use the better format (using v2)</p>
</li>
<li>
<p>You can gradually migrate users from v1 to v2</p>
</li>
<li>
<p>Eventually, you deprecate v1 (after giving warning)</p>
</li>
</ul>
<h3><strong>Method 1: URL Path Versioning (The Most Common)</strong></h3>
<p>This is what most APIs do. The version is right in the URL:</p>
<pre><code class="language-bash">GET /v1/users

GET /v2/users

GET /v3/users
</code></pre>
<p>Let’s  walk  through a real scenario:</p>
<p>Your Startup's Journey:
━━━━━━━━━━━━━━━━━━━━━</p>
<p>| 2023: Launch API v1</p>
<pre><code class="language-bash">GET /v1/products
</code></pre>
<p>Returns:</p>
<pre><code class="language-json">{&quot;id&quot;: 1, &quot;price&quot;: 19.99}
</code></pre>
<p>2024: Want to support multiple currencies</p>
<p>Launch API v2</p>
<pre><code class="language-bash">
GET /v2/products
</code></pre>
<p>Returns:</p>
<pre><code class="language-json">{&quot;id&quot;: 1, &quot;price&quot;: {&quot;amount&quot;: 19.99, &quot;currency&quot;: &quot;USD&quot;}}
</code></pre>
<p>Keep v1 running for existing users</p>
<p>2025: Want to add tax calculation</p>
<p>Launch API v3</p>
<pre><code class="language-bash">GET /v3/products
</code></pre>
<pre><code class="language-json"> {        &quot;id&quot;: 1,
           &quot;price&quot;:
   {          &quot;amount&quot;: 19.99,

               &quot;currency&quot;: &quot;USD&quot;,

               &quot;tax&quot;: 1.60,

               &quot;total&quot;: 21.59        }      }
</code></pre>
<p>2026: Announce v1 deprecation</p>
<p>&quot;v1 will shut down in 6 months&quot;</p>
<p>Give users time to upgrade</p>
<p>2026 (6 months later):</p>
<p>Turn off v1</p>
<p>Now only v2 and v3 are running</p>
<p><strong>Pros:</strong></p>
<ul>
<li>
<p>Very clear which version you're using</p>
</li>
<li>
<p>Easy to test different versions</p>
</li>
<li>
<p>Can run multiple versions simultaneously</p>
</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>
<p>URLs change when version changes</p>
</li>
<li>
<p>Need to maintain multiple codebases</p>
</li>
</ul>
<h3><strong>Method 2: Header Versioning (The Clean URL Approach)</strong></h3>
<p>Some APIs keep the URL clean and put the version in headers:</p>
<pre><code class="language-bash">
GET /users
</code></pre>
<p>Accept: application/vnd.myapi.v1+json</p>
<p>vs</p>
<pre><code class="language-bash">
GET /users
</code></pre>
<p>Accept: application/vnd.myapi.v2+json</p>
<p>Let’s see  a conversation:</p>
<p>Client → Server
━━━━━━━━━━━━━━━</p>
<pre><code class="language-bash"> &quot;GET /products
</code></pre>
<pre><code class="language-json">
Server: &quot;You want v2? Here you go:&quot;

{          &quot;id&quot;: 1,          &quot;price&quot;: {            &quot;amount&quot;: 19.99,           &quot;currency&quot;: &quot;USD&quot;          }        }

</code></pre>
<p>Same URL, different version!</p>
<p>Pros:</p>
<ul>
<li>
<p>Clean URLs (always just <code>/products</code>)</p>
</li>
<li>
<p>RESTful purists prefer this</p>
</li>
<li>
<p>Clients explicitly request version</p>
</li>
</ul>
<p>Cons:</p>
<ul>
<li>
<p>Harder to test (can't just paste URL in browser)</p>
</li>
<li>
<p>Not visible in logs easily</p>
</li>
</ul>
<h3><strong>Method 3: Query Parameter Versioning</strong></h3>
<pre><code class="language-bash">
GET /users?version=1
</code></pre>
<pre><code class="language-bash">GET /users?version=2
</code></pre>
<p>This is less common but simple.</p>
<h3><strong>What Should Change Between Versions?</strong></h3>
<p>The rule of thumb:</p>
<p><strong>Breaking Changes (need new version):</strong></p>
<p>Removing a field</p>
<pre><code class="language-json">
v1: {&quot;name&quot;: &quot;John&quot;}

v2: {} ← Missing field\! BREAKING\

</code></pre>
<p>Changing field type</p>
<pre><code class="language-json">v1: {&quot;age&quot;: &quot;25&quot;}
//returns age as string
</code></pre>
<pre><code class="language-json">
v2: {&quot;age&quot;: 25}
//returns age as number

</code></pre>
<p>BREAKING</p>
<p>Changing field name</p>
<pre><code class="language-json">
v1: {&quot;user_name&quot;: &quot;john&quot;}

v2: {&quot;username&quot;: &quot;john&quot;}
</code></pre>
<p>BREAKING</p>
<p>❌ Removing an endpoint</p>
<pre><code class="language-bash">v1: DELETE /users/123 exists


v2: DELETE /users/123 removed  ← BREAKING
</code></pre>
<p><strong>Non-Breaking Changes (same version):</strong></p>
<p>✅ Adding optional fields</p>
<p>v1: {&quot;name&quot;: &quot;John&quot;}</p>
<p>v1.1: {&quot;name&quot;: &quot;John&quot;, &quot;nickname&quot;: &quot;Johnny&quot;}</p>
<p>← Extra field, OK</p>
<p>Adding new endpoints</p>
<p>v1: GET /users exists</p>
<p>v1.1: GET /users/123/posts added  ← New endpoint, OK\</p>
<p>✅ Making required field optional</p>
<p>v1: email required</p>
<p>v1.1: email optional</p>
<p>More flexible, OK\</p>
<p>✅ Fixing bugs (that don't change contract)</p>
<p>v1: Returns wrong calculation</p>
<p>v1.1: Returns correct calculation  ← Same format, OK! |</p>
<h3><strong>Real Example: Stripe's API</strong></h3>
<p>Let’s see how a professional API (Stripe) does versioning:</p>
<p>Stripe's approach:
━━━━━━━━━━━━━━━━━</p>
<p>Every API call includes version:</p>
<pre><code class="language-bash">POST /v1/charges
</code></pre>
<p>Stripe-Version: 2023-10-16</p>
<p>Stripe has DATED versions:</p>
<p>- 2023-10-16</p>
<p>- 2024-01-15</p>
<p>- 2024-06-20</p>
<p>When you create an account, you're locked to that version.
You can upgrade when ready!</p>
<h3><strong>The Deprecation Dance</strong></h3>
<p>Here's how to retire an old version responsibly:</p>
<p>Step 1: Announce deprecation (12 months ahead)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</p>
<pre><code class="language-bash">GET /v1/users
</code></pre>
<p>Response:</p>
<p>Warning: API v1 is deprecated. It will be removed on 2026-10-19.</p>
<p>Please migrate to v2:</p>
<p>https://docs.myapi.com/v2-migration</p>
<p>Step 2: Remind users (6 months ahead)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</p>
<pre><code class="language-bash"> GET /v1/users
</code></pre>
<p>Response:Warning: API v1 will be removed in 6 months</p>
<p>Only 20% of users have migrated. Start now</p>
<p>Step 3: Final warning (1 month ahead)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</p>
<pre><code class="language-bash"> GET /v1/users
</code></pre>
<p>Response:</p>
<p>URGENT: API v1 will be removed in 30 days</p>
<p>Migrate to v2 immediately</p>
<p>Step 4: Shutdown
━━━━━━━━━━━━━━━</p>
<pre><code class="language-bash"> GET
 /v1/users
</code></pre>
<p>Response:410 Gone</p>
<pre><code class="language-json">
{  &quot;error&quot;: &quot;API v1 is no longer available&quot;,  &quot;message&quot;:

&quot;Please use v2: https://api.myapi.com/v2/users&quot;}
</code></pre>
</body>
    </html>